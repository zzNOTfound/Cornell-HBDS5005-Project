---
title: "Final Project "
author: "Jiefei Hu, Minhee Kwon, Yaoting li, Xueqing Zhou"
date: "Dec 6th, 2022"
output:
  html_document:
    toc: yes
    toc_float: yes
    fig_height: 4.5
    fig_width: 4.5
  pdf_document:
    fig_height: 3.5
    fig_width: 3.5
  word_document:
    toc: no
---

```{r options, include=FALSE}
knitr::opts_chunk$set(cache=FALSE, error=FALSE, message=FALSE, warning=FALSE)
```

```{r load_packages}
## load needed packages
library(formatR)
library(readr)
library(tidyverse)
library(ggplot2)
library(knitr)
library(dplyr)
library(tidyr)
```

## Part 1: Data

Explanation about data below

Load data
```{r}
## load data
data.file = paste(sep="/", "brfss2013.RData")
load(data.file)
dim(brfss2013)
head(brfss2013)

df <- tibble(brfss2013)
```

## Part 2: Research Questions

## Research question 1: 
Is there an association between general health and sleeping hours? If there is, is there any difference between sex and age? (Maybe we can find association with mental health in addition to general health?)

## Variables of interst:
 - genhlth : general health (Poor, Fair, good, very good, Excellent)
 - sleptim1 : amount of sleep
 - sex : Respondents Sex
 
## Research question 2:
Is there a correlation between eating fruits and general health? (Maybe we could find association with obese and weight as well?)
 - 

## Part 3: Exploratory data analysis

```{r}
## data wrangling
data <- df %>%
  select(genhlth, sleptim1, sex, menthlth, fruit1, fruitju1)
data
```
## Research question 1
```{r}
data1 <- data %>% 
  select(genhlth, sleptim1, sex) %>%
  drop_na() %>%
  filter(sleptim1 <25) %>%
  group_by(genhlth, sex) %>%
  summarize(avg_sleep = mean(sleptim1))
data1
```
```{r}
ggplot(df, aes(x=genhlth)) + geom_bar() + labs(x = "general health")
```


```{r}
p <- data1 %>%
  ggplot() + geom_col(aes(x = genhlth, y = avg_sleep, fill = sex), position = "dodge") + xlab("general health") +
  ggtitle("general health vs avg sleep")

p
```

